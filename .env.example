# =============================================
#  ELIMFILTERS API - Environment Variables
# =============================================

# Server Configuration
PORT=8080
NODE_ENV=production

# Google Sheets Integration (Optional)
GOOGLE_SHEETS_ID=your_sheet_id_here
# Option A: Paste full service account JSON (single-line)
# GOOGLE_CREDENTIALS={"type":"service_account","project_id":"...","client_email":"...","private_key":"-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"}

# Option B: Use email + private key as separate variables
# GOOGLE_SERVICE_ACCOUNT_EMAIL=your-service-account@your-project.iam.gserviceaccount.com
# GOOGLE_PRIVATE_KEY=-----BEGIN PRIVATE KEY-----\nYOUR_KEY_CONTENT_WITH_ESCAPED_NEWLINES\n-----END PRIVATE KEY-----\n

# MongoDB Connection (Optional - for future use)
# MONGODB_URI=mongodb://localhost:27017/elimfilters

# =============================================
#  Backups to S3 (for MongoDB backup service)
# =============================================
# Required for backup script (scripts/backup_mongo_to_s3.js)
# S3_BUCKET=your_bucket_name
# S3_REGION=us-east-1
# S3_ACCESS_KEY_ID=AKIAXXXXXXXX
# S3_SECRET_ACCESS_KEY=xxxxxxxxxxxxxxxx
# S3_PREFIX=mongo_backups
# Optional: override DB name if URI does not include it
# BACKUP_DB_NAME=elimfilters

# Railway Cron (set in the backup service on Railway dashboard)
# Example: run every day at 03:00 UTC
# RAILWAY_CRON_SCHEDULE=0 3 * * *

# =============================================
#  Restore from S3 (optional)
# =============================================
# To restore a specific archive, set S3_OBJECT_KEY to s3 key
# Example: mongo_backups/elimfilters/elimfilters_2025-11-30T21-40-00-000Z.tar.gz
# S3_OBJECT_KEY=
# If not set, the restore script will use the latest .tar.gz under prefix/db
# Clear existing data before import (use with caution)
# CLEAR_BEFORE_RESTORE=false

# API Keys (Optional)
# API_KEY=your_api_key_here

# Scraper Configuration
SCRAPER_TIMEOUT=10000
SCRAPER_MAX_RETRIES=3

# Fleetguard API (HD enrichment)
# Set base to official endpoint if provided by Fleetguard
FLEETGUARD_API_BASE="https://www.fleetguard.com/api/v1"
# Optional bearer token if the API requires auth
FLEETGUARD_API_TOKEN=

# Market Region Prioritization
# Set regional aftermarket ordering. Allowed values include:
# - EU     → boosts MANN, HIFI FILTER, PURFLUX, VALEO
# - LATAM  → boosts TECFIL, WEGA, VOX, GFC
# - NA/US  → boosts NAPA, STP, CHAMP, MICROGARD
# Uncomment to enable (example for QA Europe):
# MARKET_REGION=EU

# Language & Localization
# Supported languages for API messages. Default is 'en' if unset.
# Comma-separated list of ISO codes: en,es
SUPPORTED_LANGUAGES=en,es

# Cache Configuration
CACHE_TTL=3600
CACHE_MAX_ITEMS=1000

# Logging
LOG_LEVEL=info

# =============================================
#  Observability & Auto‑Self‑Test (Webhook)
# =============================================
# Incoming webhook (Slack/Teams) para el reporte diario
# Ejemplo Slack: https://hooks.slack.com/services/T000/B000/XXXX
DAILY_REPORT_WEBHOOK_URL=

# Ejecutar automáticamente una prueba del webhook al arrancar el servicio
# true/false (predeterminado: false si no se define)
AUTO_SELF_TEST_ON_START=true

# Retraso antes de ejecutar la auto‑prueba (milisegundos)
SELF_TEST_START_DELAY_MS=3000

# Horas de ventana para el reporte (usado por la auto‑prueba)
REPORT_HOURS=24

# Umbral de aprendizaje (3 acelerado, 5 robusto)
SELF_HEAL_THRESHOLD=3

# Ventana de estabilización y objetivo de reducción
SELF_HEAL_STABILIZATION_HOURS=48
SELF_HEAL_REDUCTION_TARGET=0.8
SELF_HEAL_MIN_PREV_COUNT=30
